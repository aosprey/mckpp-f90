<!-- Test KPP output -->

<simulation>

  <context id="xios">

    <variable_definition>
      <variable id="using_server" type="bool">false</variable>
      <variable id="info_level" type="int">100</variable>
      <variable id="print_file" type="bool">true</variable>
    </variable_definition>

  </context>

  <context id="kpp">

    <domain_definition>
      <domain id="domain_kpp"/>
    </domain_definition>

    <axis_definition>
      <axis id="axis_kpp" />
    </axis_definition>

    <grid_definition>

      <grid id="grid_kpp_2d">
        <domain domain_ref="domain_kpp"/>
      </grid>

      <grid id="grid_kpp_3d">
	<domain domain_ref="domain_kpp"/>
	<axis axis_ref="axis_kpp"/>
      </grid> 

    </grid_definition>

    <!-- All possible diagnostics -->
    <field_definition enabled="true" default_value="1e20">

	<field id="T" name="T" long_name="Temperature" unit="degC" grid_ref="grid_kpp_3d" />
	<field id="S" name="S" long_name="Salinity" unit="o/oo" grid_ref="grid_kpp_3d"/>

    </field_definition> 

    <!-- Output files -->
    <file_definition type="one_file" par_access="collective" enabled=".TRUE.">

      <!-- Instantaneous -->
      <file id="output_kpp_3d" name="output_kpp_3d" output_freq="1h"> 
	<field field_ref="T" operation="instant"/>
	<field field_ref="S" operation="instant"/>
      </file> 

      <!-- Mean -->
      <file id="output_kpp_3d_means" name="output_kpp_3d_means" output_freq="3h"> 
	<field field_ref="T" name="T_mean" operation="average"/>
	<field field_ref="S" name="S_mean" operation="average"/>
      </file> 
     
      <!-- Minimum -->
      <file id="output_kpp_3d_min" name="output_kpp_3d_min" output_freq="3h"> 
	<field field_ref="T" name="T_min" operation="minimum"/>
	<field field_ref="S" name="S_min" operation="minimum"/>
      </file> 
    
      <!-- Maximum --> 
      <file id="output_kpp_3d_max" name="output_kpp_3d_max" output_freq="3h"> 
	<field field_ref="T" name="T_max" operation="maximum"/>
	<field field_ref="S" name="S_max" operation="maximum"/>
      </file>

    </file_definition> 

  </context>

</simulation>
